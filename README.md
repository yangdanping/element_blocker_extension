# Element Blocker Chrome 插件

一个功能强大的 Chrome 浏览器插件，支持根据 CSS 类名智能屏蔽网页元素，具备域名隔离和可视化管理功能。

## 功能特性

### 核心功能

- **智能匹配**：支持类名包含匹配和组合匹配两种模式
- **可视化选择**：点击页面元素直接添加到屏蔽列表
- **实时生效**：添加规则后立即生效，无需刷新页面
- **域名隔离**：每个域名独立管理屏蔽规则
- **数据持久化**：屏蔽规则自动保存，支持本地备份

### 高级功能

- **多级开关**：总开关 + 域名开关 + 单项开关
- **智能图标**：动态显示当前域名屏蔽状态
- **快捷键支持**：`Ctrl+E` (Mac: `Cmd+E`) 快速切换域名屏蔽
- **智能去重**：自动检测重复或包含关系的规则
- **分类管理**：按域名分组显示屏蔽规则
- **设置页面**：完整的配置和管理界面

### 匹配模式

- **包含匹配**：单个类名片段，匹配所有包含该文本的类名
- **组合匹配**：多个类名组合，只屏蔽同时包含所有指定类的元素

## 图标状态

插件图标会根据当前域名的屏蔽状态动态变化：

- **默认图标** (icon.png)：当前域名下没有激活的屏蔽项
- **激活图标** (icon-active.png)：当前域名下有至少一项激活的屏蔽项

## 安装方法

### 开发者模式安装

1. 打开 Chrome 浏览器
2. 进入扩展程序管理页面：`chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择插件文件夹 `element-blocker-extension`
6. 插件安装完成

## 使用方法

### 方法一：手动输入类名

1. 点击浏览器工具栏中的插件图标
2. 在输入框中输入要屏蔽的类名片段
3. 点击"添加"按钮
4. 屏蔽规则立即生效

**包含匹配示例**：

- 输入 `ad` → 屏蔽 `advertisement`, `sidebar-ad`, `ad-container` 等
- 输入 `banner` → 屏蔽 `top-banner`, `banner-img`, `promotional-banner` 等

**组合匹配示例**：

- 输入 `card item` → 只屏蔽同时包含 `card` 和 `item` 类的元素

### 方法二：可视化选择元素

1. 点击插件图标打开弹窗
2. 点击"选择元素"按钮
3. 鼠标悬停在页面元素上显示高亮框
4. 点击要屏蔽的元素
5. 选择屏蔽单个类名或组合类名
6. 按 `Esc` 键退出选择模式

### 快捷键操作

- **`Ctrl+E`** (Mac: `Cmd+E`)：快速切换当前域名的屏蔽状态

### 管理屏蔽规则

- **查看规则**：按域名分组显示所有屏蔽规则
- **启用/禁用**：点击规则项切换单项启用状态
- **删除规则**：点击规则右侧的"×"按钮
- **域名管理**：区分当前域名、全局规则和其他域名规则
- **批量操作**：使用总开关控制所有屏蔽功能

## 文件结构

```
element-blocker-extension/
├── manifest.json          # 插件配置文件 (Manifest V3)
├── background.js          # 后台脚本 (图标管理、快捷键)
├── popup.html            # 弹窗界面
├── popup.js              # 弹窗逻辑
├── options.html          # 设置页面
├── options.js            # 设置页面逻辑
├── js/
│   └── content.js        # 内容脚本 (核心屏蔽逻辑)
├── css/
│   ├── popup.css         # 弹窗样式
│   ├── options.css       # 设置页面样式
│   └── content.css       # 内容脚本样式
├── icons/
│   ├── icon.png          # 默认图标
│   ├── icon.svg          # 默认图标 (矢量)
│   ├── icon-active.png   # 激活状态图标
│   └── icon-active.svg   # 激活状态图标 (矢量)
└── README.md             # 说明文档
```

## 技术实现

### 核心技术

- **Manifest V3**：使用最新的 Chrome 扩展标准
- **Service Worker**：后台脚本处理图标状态和快捷键
- **Content Scripts**：在网页中注入屏蔽逻辑
- **Chrome Storage API**：持久化存储屏蔽规则
- **Chrome Action API**：动态切换插件图标

### 数据结构

```javascript
// 屏蔽项数据结构
{
  className: "ad-banner",     // 类名（支持空格分隔的组合类名）
  enabled: true,              // 是否启用
  domain: "example.com"       // 所属域名 (null表示全局)
}
```

### 匹配算法

- **单类名**：使用 `[class*="className"]` 选择器实现包含匹配
- **组合类名**：使用 `[class~="class1"][class~="class2"]` 选择器实现 AND 逻辑

## 权限说明

插件需要以下权限：

- **`storage`**：保存屏蔽规则和设置
- **`activeTab`**：获取当前标签页信息
- **`tabs`**：监听标签页切换，更新图标状态

## 使用场景

### 常见应用

- **广告屏蔽**：屏蔽包含 `ad`, `ads`, `advertisement` 的元素
- **横幅移除**：屏蔽 `banner`, `header-banner`, `promo-banner`
- **弹窗阻止**：屏蔽 `popup`, `modal`, `overlay`
- **侧边栏隐藏**：屏蔽 `sidebar`, `aside`, `side-panel`

### 高级用法

- **精确匹配**：使用组合类名如 `card product` 精确定位
- **域名隔离**：不同网站使用不同的屏蔽规则
- **临时禁用**：快捷键快速切换屏蔽状态

## 注意事项

1. **兼容性**：支持 Chrome 88+版本
2. **数据同步**：屏蔽规则仅在本地存储，不同设备间不同步
3. **动态内容**：对于异步加载的内容，屏蔽规则会自动应用
4. **性能影响**：大量屏蔽规则可能影响页面加载性能
5. **网站兼容**：某些使用 Shadow DOM 的网站可能无法正常屏蔽

## 扩展建议

### 计划中的功能

- **规则导入/导出**：支持备份和分享屏蔽规则
- **白名单模式**：指定网站不应用屏蔽规则
- **时间控制**：定时启用/禁用屏蔽功能
- **统计信息**：显示屏蔽数量和效果统计
- **云同步**：跨设备同步屏蔽规则

### 开发者扩展

- **API 支持**：提供外部调用接口
- **自定义选择器**：支持更复杂的 CSS 选择器
- **脚本注入**：支持自定义 JavaScript 代码
- **主题支持**：自定义界面主题

## 图标设计

插件包含两套图标：

- **默认状态**：灰色调，表示无激活屏蔽
- **激活状态**：彩色或高亮，表示有激活屏蔽

图标尺寸：16px、32px、48px、128px，支持 PNG 和 SVG 格式。

## 许可证

本项目采用 MIT 许可证，详情请参阅 LICENSE 文件。

## 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目！

## 支持

如果遇到问题或有功能建议，请在 GitHub 上提交 Issue。
